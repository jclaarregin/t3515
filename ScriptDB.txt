drop database if exists ganaderia;
create database ganaderia;
use ganaderia;



create table tatuaje(
	cod_tatuaje int(4) auto_increment primary key,
	tatuaje varchar(4) not null,
	caravana varchar(8) not null,
	colocacion_caravana date,
	observacion varchar(50),
	index (tatuaje,caravana));


create table raza(
	cod_raza int(11) auto_increment primary key,
	desc_raza varchar(20) not null,
	index(desc_raza));


create table categoria(
	cod_categoria int(4) auto_increment primary key,
	desc_categoria varchar(30) not null,
	index(desc_categoria));


create table lote(
	cod_lote int(11) auto_increment primary key,
	desc_lote varchar(30) not null,
	index(desc_lote));


create table potrero(
	cod_potrero int(11) auto_increment,
	cod_lote int(11) not null,
	desc_potrero varchar(30) not null,
	hectareas int(11),
	index(desc_potrero),
	primary key(cod_potrero,cod_lote),
	foreign key (cod_lote) references lote(cod_lote));


create table pesador(
	nro_dni int(8) primary key not null,
	nom_pesador varchar(30) not null);


create table ejemplar(
	cod_ejemplar int(11) auto_increment primary key,
	fecha_nacimiento date,
	carimbo int(2) not null,
	cod_tatuaje int(4) not null,
	cod_raza int(11) not null,
	cod_categoria int(11) not null,
	peso_inicial double,
	observaciones varchar(50),
	foreign key (cod_tatuaje) references tatuaje(cod_tatuaje),
	foreign key (cod_raza) references raza(cod_raza),
	foreign key (cod_categoria) references categoria(cod_categoria));


create table pesada(
	cod_pesada int(11) auto_increment,
	cod_ejemplar int(11) not null,
	cod_potrero int(11) not null,
	cod_lote int(11) not null,
	fecha date not null,
	pesador int(8),
	observaciones varchar(50),
	primary key (cod_pesada,cod_ejemplar,cod_potrero,cod_lote),
	foreign key (cod_ejemplar) references ejemplar(cod_ejemplar),
	foreign key (cod_potrero,cod_lote) references potrero(cod_potrero,cod_lote),
	foreign key (pesador) references pesador(nro_dni));


create table registro_pesada(
	id_registro int(11) auto_increment primary key,
	tatuaje_r varchar(4) not null,
	caravana_r varchar(4) not null,
	carimbo_r int(2) not null,
	peso_r double not null,
	cod_pesada_r int(11),
	cod_ejemplar_r int(11) not null,
	cod_potrero_r int(11) not null,
	cod_lote_r int(11) not null,
	foreign key (cod_pesada_r,cod_ejemplar_r,cod_potrero_r,cod_lote_r) references pesada(cod_pesada,cod_ejemplar,cod_potrero,cod_lote));


